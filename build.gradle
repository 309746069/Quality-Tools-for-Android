buildscript {
	repositories { 
         mavenCentral()
	}
	dependencies { 
		classpath 'com.android.tools.build:gradle:0.5.6'
		
	}
}

configure(allprojects) {
	group = 'com.octo.android'

	ext.androidVersion           = "4.1.1.4"
	ext.androidSupportVersion    = "18.0.0"
	ext.jodaLibraryVersion    = "2.2"

}

configure(subprojects) { subproject ->

	repositories {
	     mavenCentral()
	     mavenLocal()
	}

}

//-------------------------
//-- Android Sample Project
//-------------------------

project('android-sample') {
	description = "Android sample app under tests"

	apply plugin: 'android'
	apply plugin: 'eclipse'
	
	dependencies {
     compile "joda-time:joda-time:$jodaLibraryVersion"
     compile "com.android.support:support-v4:$androidSupportVersion"
     
     instrumentTestCompile 'com.jayway.android.robotium:robotium-solo:4.0'
     instrumentTestCompile 'org.hamcrest:hamcrest-core:1.3'
     //due to a stupid conflict with licence file TODO
     //instrumentTestCompile 'org.mockito:mockito-core:1.9.5'  
     instrumentTestCompile 'com.squareup.spoon:spoon-client:1.0.1'
     instrumentTestCompile 'com.squareup:fest-android:1.0.3'
     instrumentTestCompile 'org.easymock:easymock:3.2' exclude group: 'cglib'
     instrumentTestCompile 'cglib:cglib-nodep:2.2' 
	}
	    
	  
	android {
	    buildToolsVersion "17.0"                
	    compileSdkVersion 17
	    
	    sourceSets {
	        main {
	            manifest.srcFile 'AndroidManifest.xml'
	            java.srcDirs = ['src/main/java']
	            resources.srcDirs = ['src']
	            //aild.srcDirs = ['src']
	            renderscript.srcDirs = ['src']
	            res.srcDirs = ['res']
	            assets.srcDirs = ['assets']
	        }
	    
	        instrumentTest.setRoot('../android-sample-tests')
	        instrumentTest {
		      java {
		         srcDirs = ['../android-sample-tests/src/main/java']
		         //due to a stupid conflict with licence file TODO
		         exclude '**/HelloAndroidActivityTest.java'
		      }
		      res.srcDirs = ['res']
		      assets.srcDirs = ['../android-sample-tests/assets']
		      resources.srcDirs = ['../android-sample-tests/src']
		    }
	    }
	    
	    defaultConfig {
	        testPackageName "com.octo.android.sample.test"
	        testInstrumentationRunner "android.test.InstrumentationTestRunner"
    	}

	    android.applicationVariants.each { variant ->
	        variant.install.doLast {
	            def result = exec {
	                executable = 'adb'
	                args = ['shell', 'am', 'start', '-c', 'android.intent.category.LAUNCHER', '-n', 'com.octo.android.sample/.ui.HelloAndroidActivity']
	            }
	        }
	    }
	}
}

//-------------------------
//-- Android Sample Robolectric Tests Project
//-------------------------


//-------------------------
//-- Root project
//-------------------------

configure(rootProject) {
	description = 'Quality Analysis Tools for Android'

}

